@using IdeoTreeStructure.MVC.Models;
@model TreeElement
@{
    ViewBag.Title = "Index";
}
@helper ShowTree(TreeElement root)
{
<div id="root">
    @foreach (var element in root.Children)
    {

    <div class="bg-light border border-primary rounded m-2" id=@element.Id>
        <h5>@element.Id</h5>
        <button type="button" class="btn btn-danger" onclick="removeButtonClicked(@element.Id)">rm</button>
        @Html.ActionLink("edit", "EditView", "Home",
        new { @idToEdit = @element.Id }, new { @class = "btn btn-primary" })
        <button type="button" class="btn btn-dark" onclick="hideButtonClicked(@element.Id)">hide</button>
        <p>@element.Content</p>

        @if (element.Children.Any())
        {
            @ShowTree(element)
        }
    </div>

    }
</div>
}

<div class="dropdown">
    <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Sort<span class="caret"></span></button>
    <ul class="dropdown-menu">
        <li>@Html.ActionLink("alpha","Index","Home", new { sortParam = "alp" }, new { @class = "btn" })</li>
        <li>@Html.ActionLink("id", "Index", "Home", new { sortParam = "id" }, new { @class = "btn" })</li>
        <li>@Html.ActionLink("child ammount", "Index", "Home", new { sortParam = "childam" }, new { @class = "btn" })</li>
    </ul>
</div>


@ShowTree(Model)
<script>
    function removeButtonClicked(clickedId) {
        $.ajax({
            url: '@Url.Action("RemoveNode", "Home")',
            type: 'GET',
            data: { id: clickedId },
            success: function () {
                location.reload();
            }
        });
    }
    function hideButtonClicked(clickedId) {
        parentDiv = $("div#" + clickedId);
        if (parentDiv.children("div").is(':visible')) {
            parentDiv.children("div").hide();
        }
        else {
            parentDiv.children("div").show();
        }
    }
    function sortAlphabetically() {
        $("div#root").children("div").sort(function (a, b) {
            elementA = $(a).children('p').text();
            elementB = $(b).children('p').text();
            return a > b;
        })
    }
</script>